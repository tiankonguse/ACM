# A - 王者荣耀
根据题意模拟即可。

# B - 负载均衡
假设我们已知 $0$ 号请求占用 $0$ 号服务器的资源量为 $x$，那么 $0$ 号请求占用 $1$ 号服务器的资源量即为 $(r_0 - x)$。由于 $1$ 号服务器只能接受 $0$ 号请求和 $1$ 号请求，那么 $1$ 号服务器剩余的 $(s_1 - r_0 + x)$ 的资源应该全部分给 $1$ 号请求才最优。后续资源分配方案以此类推。也就是说，如果我们已知 $x$，我们就能在 $\mathcal{O}(n)$ 的复杂度内判断是否存在合法的分配方案。

因为 $x$ 也是未知的，所以我们考虑枚举 $x$。这样的复杂度是 $\mathcal{O}(r_0n)$ 的，由于 $r_0$ 最大可达 $107$，而 $n$ 也有 $105$，因此很可能超时。

我们更换一下枚举对象。设 $r_k$ 为所有 $r$ 中的最小值，我们枚举 $k$ 号请求占用 $k$ 号服务器的资源量。这样的复杂度是 $\mathcal{O}(r_kn)$ 的。由于 $r_k$ 是所有 $r$ 中的最小值，因此有 $r_k \le \frac{\sum\limits_{i=0}{n-1} r_i}{n}$。那么最终复杂度就是 $\mathcal{O}(\sum\limits_{i=0}{n-1} r_i)$，也就是 $10^7$，可以通过本题。


# C - 翻转字符串
如果所有字符都是一样的，答案为 "Impossible"。

如果原字符串已经符合要求，答案为 $0$。

设原字符串中最小的字符为 $c$。如果第一个字符不是 $c$，那么我们选择一个以 $c$ 开头的后缀进行操作，即可将字符串变为以 $c$ 结尾，此时的字符串一定符合要求。这种情况下答案为 $1$。

如果第一个字符是 $c$，那么我们首先选择整个字符串进行操作（例如原字符串为 "cpt"，操作后变为 "cpttpc"），再选择长度为 $1$ 的后缀（也就是最后一个字符）进行操作（"cpttpc" 变为 "cpttpcc"）。这样至多需要 $2$ 次操作即可使字符串符合要求。

因此答案至多为 $2$，我们只需要检查答案是否可能为 $1$ 即可。枚举所有后缀，并用二分 + 哈希的方式找到字符串正着读和倒着读第一个不同字符的位置即可。

# D - 树上的逆序对
逆序对的计算分为两部分：若祖先节点为 $1$，后继节点为 $0$，则一定会产生一个逆序对；另外子树之间也会产生逆序对。

考虑两个拥有相同父节点 $p$ 的节点 $u$ 和 $v$。设以 $u$ 为根的子树中有 $u_0$ 个 $0$ 以及 $u_1$ 个 $1$，以 $v$ 为根的子树中有 $v_0$ 个 $0$ 以及 $v_1$ 个 $1$。如果 DFS 到 $p$ 以后，先访问 $u$ 再访问 $v$ 得到的逆序对数比先访问 $v$ 再访问 $u$ 来得多，那么有不等式 $u_1v_0 > v_1u_0$。根据这个不等式排出访问所有子节点的顺序即可。

# E - 回文数
维护以下状态：$f(i, 0/1, 0/1)$ 表示两个长度为 $i$ 的数相加，最高位是否有进位（例如 $99 + 32 = 121$，此时最高位就有进位），最低位是否被进位（例如 $99 + 32 = 121$，最低位被进位，也就是加 $1$ 之后，结果变为 $122$），结果的最低 $i$ 位构成回文数的方案数。

从 $i$ 转移到 $(i + 2)$ 时，枚举最高位新增的两个数码，以及最低位新增的两个数码即可。

最终统计答案的时候分成两种情况：回文数的长度为 $n$（最高位不进位），以及回文数的长度为 $(n + 1)$（最高位进位）。后一种情况需要我们先算出不含前导零且长度为 $(n - 1)$ 的两个数相加的情况，然后枚举最低位新增哪两个数码，且这两个数码加起来的个位数必须是 $1$。

注意由于要求相加的两个数不含前导零，因此我们实际上要先通过矩阵快速幂算出两个长度为 $(n - 2)$ 或 $(n - 3)$ 的数相加的情况，然后枚举最高位新增的两个数码（都不能为 $0$），以及最低位新增的两个数码，以及最高和最低位是否有进位。

初值就是 $i = 0$ 或 $i = 1$ 时的情况。$i = 0$ 的情况有 $f(0, 0, 0) = f(0, 1, 1) = 1$，$i = 1$ 的情况则是枚举两个数码以及最低位是否被进位。
