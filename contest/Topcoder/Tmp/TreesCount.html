<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td>Little Dazdraperma likes graphs a lot. Recently she invented a new game for one person with graphs. She is given a connected
undirected graph with N vertices numbered 0 to N-1, inclusive (see the notes for definitions of all unclear terms from graph theory). Each edge of the graph is labeled with a positive integer length. She tries to remove some edges (possibly 0) so that the resulting graph satisfies the following conditions:
<ul>
<li>The graph that remains is a tree with exactly N-1 edges.</li>
<li>For each v, 0 &lt; v &lt; N, the shortest distance between vertex 0 and vertex v is the same in the resulting graph and in the initial graph.</li></ul>
Dazdraperma wonders how many different resulting graphs that satisfy these conditions she can obtain. Two graphs are considered different if there are two different vertices such that one of the graphs contains an edge between these two vertices and another graph doesn't contain an edge between them.
<br></br>
<br></br>
You are given the representation of the initial graph as a vector &lt;string&gt; <b>graph</b>. This vector &lt;string&gt; contains exactly N elements and each element contains exactly N characters. The j-th
character in the i-th element will be '0' if there is no edge between vertices
i and j. Otherwise, it will be a character between '1' and '9' representing the length of the edge between vertices i and j.
<br></br>
<br></br>
Return the number of possible resulting graphs modulo 1000000007.</td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>TreesCount</td></tr><tr><td>Method:</td><td>count</td></tr><tr><td>Parameters:</td><td>vector &lt;string&gt;</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int count(vector &lt;string&gt; graph)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td>&#160;&#160;&#160;&#160;</td></tr><tr><td></td></tr><tr><td colspan="2"><h3>Notes</h3></td></tr><tr><td align="center" valign="top">-</td><td>For the purpose of this problem, an undirected graph can be treated as a set of vertices and a set of edges, where each edge establishes a bidirectional connection between two different vertices.</td></tr><tr><td align="center" valign="top">-</td><td>A path between two different vertices A and B in a graph G is a sequence of 2 or more vertices v[0] = A, v[1], ..., v[L-1] = B, such that there's an edge in G between each two adjacent vertices in this sequence. A path is said to consist of edges between v[i] and v[i+1], where 0 &le; i &lt; L-1. The length of a path is the sum of lengths of all edges it consists of. </td></tr><tr><td align="center" valign="top">-</td><td>The path between vertices A and B in a graph G that has the minimum possible length is called the shortest path between them. The length of this path is called the shortest distance between A and B.</td></tr><tr><td align="center" valign="top">-</td><td>A graph G is connected if there's a path between each two different vertices of G.</td></tr><tr><td align="center" valign="top">-</td><td>A graph G is a tree if it is connected and contains exactly V-1 edges, where V is the total number of vertices in G.</td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>graph</b> will contain between 2 and 50 elements, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>graph</b> will contain the same number of characters as the number of elements in <b>graph</b>.</td></tr><tr><td align="center" valign="top">-</td><td>Each character in each element of <b>graph</b> will be between '0' and '9', inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>For each i, the i-th character of i-th element of <b>graph</b> will always be '0'.</td></tr><tr><td align="center" valign="top">-</td><td>For each i and j, the i-th character of j-th element of <b>graph</b> will always be equal to the j-th character of i-th element of <b>graph</b>.</td></tr><tr><td align="center" valign="top">-</td><td><b>graph</b> will represent a connected graph.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;01&quot;,
 &quot;10&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 1</pre></td></tr><tr><td><table><tr><td colspan="2">The graph is already a tree, so the answer is 1.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;011&quot;,
 &quot;101&quot;,
 &quot;110&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 1</pre></td></tr><tr><td><table><tr><td colspan="2">The only possibility is to delete the edge between vertices 1 and 2.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;021&quot;,
 &quot;201&quot;,
 &quot;110&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 2</pre></td></tr><tr><td><table><tr><td colspan="2">You can either delete the edge between vertices 1 and 2 or the edge between vertices 0 and 1.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;0123&quot;,
 &quot;1012&quot;,
 &quot;2101&quot;,
 &quot;3210&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 6</pre></td></tr><tr><td><table><tr><td colspan="2">More possibilities.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;073542&quot;,
 &quot;705141&quot;,
 &quot;350721&quot;,
 &quot;517031&quot;,
 &quot;442304&quot;,
 &quot;211140&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 2</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
