<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td>Let A be a matrix with N rows and N columns and P be a permutation of integers from 0 to N-1. Consider the following sum: <tt>Sum</tt>(A, P) = A[0, P[0]] + A[1, P[1]] + ... + A[N-1, P[N-1]], where A[i, j] is the element of A in row i and column j (all indices in this problem are 0-based). The matrix A is called <i>nice</i> if <tt>Sum</tt>(A, P) is always equal to the same value disregarding of the choice of permutation P.
<br></br><br></br>
Fox Ciel wants to draw a nice matrix on the blackboard. She is given a vector &lt;string&gt; <b>board</b>. It contains N elements and each element contains N characters. If j-th character of <b>board</b>[i] is a digit '0', '1', '2', ..., '9', then A[i, j] must be equal to this digit. If j-th character of <b>board</b>[i] is '-', then A[i, j] can be equal to any non-negative integer (it is allowed to be greater than 9).
<br></br><br></br>
Let T be the number of different matrices that satisfy all Ciel's requirements (the constraints will guarantee that the number of such matrices is finite). Compute and return the value of (T modulo 1,000,000,007).
</td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>EqualSums</td></tr><tr><td>Method:</td><td>count</td></tr><tr><td>Parameters:</td><td>vector &lt;string&gt;</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int count(vector &lt;string&gt; board)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td>&#160;&#160;&#160;&#160;</td></tr><tr><td></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>board</b> will contain between 1 and 50 elements, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>board</b> will contain exactly N characters, where N is the number of elements in <b>board</b>.</td></tr><tr><td align="center" valign="top">-</td><td>Each character in <b>board</b> will be one of '-', '0', '1', '2', ..., '9'.</td></tr><tr><td align="center" valign="top">-</td><td>The number of matrices that satisfy all Ciel's requirements will be finite.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;1-&quot;,
 &quot;-2&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 4</pre></td></tr><tr><td><table><tr><td colspan="2">The sum A[0, 1] + A[1, 0] must be equal to 3.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;123&quot;,
 &quot;4--&quot;,
 &quot;--9&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 1</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;9--&quot;,
 &quot;-9-&quot;,
 &quot;--9&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 271</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;11&quot;,
 &quot;12&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 0</pre></td></tr><tr><td><table><tr><td colspan="2">There are no nice matrices that match the given <b>board</b>, so T = 0.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;-4--&quot;,
 &quot;-0-2&quot;,
 &quot;--1-&quot;,
 &quot;4---&quot;}
</pre></td></tr></table></td></tr><tr><td><pre>Returns: 10</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">5)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;--2&quot;,
 &quot;02-&quot;,
 &quot;-10&quot;}
</pre></td></tr></table></td></tr><tr><td><pre>Returns: 0</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">6)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>{&quot;----------1---------------0-----7-----------------&quot;,
 &quot;-----4--------------------------------------------&quot;,
 &quot;--------5-------------5-3---5---------------6-----&quot;,
 &quot;-------2----------1-------------------------------&quot;,
 &quot;-----4--------------------------------------------&quot;,
 &quot;-----3--------------------------------------------&quot;,
 &quot;-6----------5-------------------------------------&quot;,
 &quot;-------------------------------7---5----------6---&quot;,
 &quot;--------6-------------6-4---6---------------7-----&quot;,
 &quot;-------------4----------------5-------------------&quot;,
 &quot;3------------------------------------------6------&quot;,
 &quot;3------------------------------------------6------&quot;,
 &quot;-------------4----------------5-------------------&quot;,
 &quot;---------------2-------------------------3--------&quot;,
 &quot;--2------------------------------------------2----&quot;,
 &quot;---8---------------1-------------------3----------&quot;,
 &quot;---------------3----------------------------------&quot;,
 &quot;----7----------------5---0-----------------------5&quot;,
 &quot;----------------5-------------------------3-----1-&quot;,
 &quot;----------1---------------0-----7-----------------&quot;,
 &quot;-------------5----------------6-------------------&quot;,
 &quot;-7----------6-------------------------------------&quot;,
 &quot;---8---------------1-------------------3----------&quot;,
 &quot;-----------------------3--------------------------&quot;,
 &quot;----8----------------6---1-----------------------6&quot;,
 &quot;------------------------------------------4-----2-&quot;,
 &quot;-----------5---------------5----------------------&quot;,
 &quot;-----------------------------6--------------------&quot;,
 &quot;----8----------------6---1-----------------------6&quot;,
 &quot;----------------5-------------------------3-----1-&quot;,
 &quot;-------------------------------6---4--2-------5---&quot;,
 &quot;-6----------5-------------------------------------&quot;,
 &quot;--------5-------------5-3---5---------------6-----&quot;,
 &quot;-------------5----------------6-------------------&quot;,
 &quot;-----3--------------------------------------------&quot;,
 &quot;---------------2-------------------------3--------&quot;,
 &quot;---------4---------------------------6------------&quot;,
 &quot;-------------------------------6---4--2-------5---&quot;,
 &quot;------2-------------1------------22---------------&quot;,
 &quot;--------5-------------5-3---5---------------6-----&quot;,
 &quot;-----------5--3------------5----------------------&quot;,
 &quot;--2------------------------------------------2----&quot;,
 &quot;---------5---------------------------7------------&quot;,
 &quot;-------------4----------------5-------------------&quot;,
 &quot;-----------------5------------------4---6------2--&quot;,
 &quot;-------------------------------6---4--2-------5---&quot;,
 &quot;-----------------------2--------------------------&quot;,
 &quot;----------------6-------------------------4-----2-&quot;, 
 &quot;-------------------------------6---4--2-------5---&quot;,
 &quot;--------5-------------5-3---5---------------6-----&quot;}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 45094393</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
